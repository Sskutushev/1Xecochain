# CI/CD Pipeline в проекте EcoChain Web3 платформы

## Описание

Проект EcoChain Web3 платформы настроен с использованием GitHub Actions для автоматизации процессов проверки, тестирования и деплоя кода.

## Конфигурации GitHub Actions

### 1. Основной CI Pipeline
- **Файл**: `.github/workflows/ci.yml`
- **Триггер**: `push` в ветку `main` и `pull_request` в ветку `main`
- **Описание**: Pipeline для проверки качества кода, запуска тестов и сборки проекта

**Джобы:**
- **lint**: Проверяет код с помощью ESLint и TypeScript
- **test**: Запускает тесты и генерирует отчет о покрытии
- **build**: Собирает проект с использованием переменной окружения `VITE_API_URL`

### 2. Preview деплой
- **Файл**: `.github/workflows/preview.yml`
- **Триггер**: `pull_request` с типами `opened`, `synchronize`
- **Описание**: Pipeline для деплоя preview-версии приложения для каждой pull request

**Джобы:**
- **preview**: Деплой на Vercel с использованием preview-окружения
- **comment**: Комментирует в PR с URL preview-версии

## Husky и lint-staged

Проект использует Husky для настройки git хуков:

- **Файл**: `.husky/pre-commit`
- **Описание**: Запускает lint-staged перед каждым коммитом
- **Функциональность**: 
  - Запускает ESLint для исправления ошибок
  - Форматирует файлы с помощью Prettier

## Переменные окружения для CI/CD

Для работы CI/CD Pipeline требуются следующие GitHub Secrets:

1. **VERCEL_TOKEN**: Токен для деплоя на Vercel
2. **VERCEL_ORG_ID**: ID вашей организации Vercel
3. **VERCEL_PROJECT_ID**: ID проекта Vercel (`prj_FLAM48oZJNspCz4TU5TofKw1jaJM` для данного проекта)
4. **VITE_API_URL**: URL для API (для сборки проекта)

## Настройка GitHub Secrets

Для настройки GitHub Secrets перейдите в репозитории:
1. Settings → Secrets and variables → Actions
2. Добавьте новые Repository secrets с указанными выше именами

## Pre-commit хуки

При установке зависимостей (через `npm install`) автоматически устанавливается Husky хук, который при каждом коммите:
1. Использует `lint-staged` для проверки только измененных файлов
2. Запускает `eslint --fix` для исправления ошибок
3. Применяет `prettier --write` для форматирования кода

## Проверка и запуск локально

Для локальной проверки работы CI/CD:

### Линтинг
```bash
npm run lint
```

### Запуск тестов
```bash
npm test
```

### Проверка тестов с покрытием
```bash
npm run test:coverage
```

### Сборка проекта
```bash
npm run build
```

## Покрытие кода

Pipeline для `test` генерирует отчет о покрытии кода тестами, который может быть отправлен в Codecov или аналогичный сервис.

## Результаты

После настройки GitHub Actions:
- При каждом PR будет создаваться preview-версия
- При мерже в main будет выполняться деплой на продакшен
- Каждый коммит проверяется на качество кода локально
- Все изменения проходят через автоматические проверки